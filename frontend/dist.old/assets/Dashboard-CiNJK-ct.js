import{j as e,F as T,B as m,G as _,r as f,u as h,M as x,s as g,a as C}from"./index-Bl3f9Dxg.js";import{H as u}from"./index-DEwfN7ey.js";import{C as n}from"./Card-DJULRFTo.js";import{u as L}from"./index.esm-BmxENRqK.js";import{T as P}from"./index-F0Avwo3O.js";import{S as y}from"./index-BomJZn6k.js";import"./SearchOutlined-BOVmvXrh.js";import"./CheckOutlined-kg7jghGR.js";function D(){return e.jsxs("div",{className:"p-4 bg-white rounded-md space-y-5 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{size:20}),e.jsx("p",{className:"text-lg font-bold ",children:"Agent Status"})]}),e.jsx(m,{icon:e.jsx(u,{}),size:"small",type:"primary",className:"!bg-yellow",children:"Refresh"})]}),e.jsx("div",{className:"w-full bg-gray-100 rounded-xl p-7 border border-gray-300 space-y-3",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("p",{className:"text-gray-500 text-center",children:["Agent status will be displayed here when connected to real data.",e.jsx("br",{}),e.jsx("span",{className:"text-sm",children:"TODO: Connect to agent status API"})]})})})]})}function O(t){return _({attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21 14h-6c-.553 0-1-.448-1-1s.447-1 1-1h6c.553 0 1 .448 1 1s-.447 1-1 1zM18 17c-.553 0-1-.448-1-1v-6c0-.552.447-1 1-1s1 .448 1 1v6c0 .552-.447 1-1 1zM9 6c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3m0-2c-2.764 0-5 2.238-5 5s2.236 5 5 5 5-2.238 5-5-2.236-5-5-5zM9 17c2.021 0 3.301.771 3.783 1.445-.683.26-1.969.555-3.783.555-1.984 0-3.206-.305-3.818-.542.459-.715 1.777-1.458 3.818-1.458m0-2c-3.75 0-6 2-6 4 0 1 2.25 2 6 2 3.518 0 6-1 6-2 0-2-2.354-4-6-4z"},child:[]}]})(t)}function R(){L();const[t,l]=f.useState(null),[r,p]=f.useState({}),{data:d,isLoading:b,mutate:j}=h("/admin-dashboard/pending-sessions/"),{data:N,isLoading:v}=h("/admin-dashboard/available-agents/"),w=()=>{j()},A=async s=>{const i=r[s];if(!i){g.error("Please select an agent first");return}l(s);try{await C.post("/admin-dashboard/assign-session/",{session_id:s,agent_id:i}),g.success("Session assigned successfully"),j(),p(a=>{const c={...a};return delete c[s],c})}catch(a){g.error(a?.response?.data?.error||"Failed to assign session")}finally{l(null)}},S=(s,i)=>{p(a=>({...a,[s]:i}))},M=s=>{switch(s){case"HIGH":return"red";case"MEDIUM":return"orange";case"LOW":return"green";default:return"default"}},z=s=>{const i=new Date,a=new Date(s),c=i.getTime()-a.getTime(),o=Math.floor(c/(1e3*60));return o<60?`${o}m ago`:`${Math.floor(o/60)}h ${o%60}m ago`};return b?e.jsxs("div",{className:"p-4 bg-white rounded-md space-y-5 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{size:20}),e.jsx("p",{className:"text-lg font-bold",children:"Pending Sessions"})]}),e.jsx(m,{icon:e.jsx(u,{}),size:"small",type:"primary",className:"!bg-yellow",loading:!0,children:"Refresh"})]}),e.jsx("div",{className:"space-y-3",children:[1,2].map(s=>e.jsxs("div",{className:"w-full bg-gray-100 rounded-xl p-7 border border-gray-300 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},s))})]}):e.jsxs("div",{className:"p-4 bg-white rounded-md space-y-5 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{size:20}),e.jsxs("p",{className:"text-lg font-bold",children:["Pending Sessions (",d?.length||0,")"]})]}),e.jsx(m,{icon:e.jsx(u,{}),size:"small",type:"primary",className:"!bg-yellow",onClick:w,children:"Refresh"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3",children:d&&d.length>0?d.map((s,i)=>e.jsxs("div",{className:"w-full bg-gray-100 rounded-xl p-4 border border-gray-300 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",i+1]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.user_name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.user_phone,")"]}),e.jsx("span",{className:"text-xs text-gray-400",children:z(s.created_at)})]}),e.jsx("p",{className:"font-normal text-sm text-gray-700 max-w-[350px] line-clamp-2",children:s.message})]}),e.jsx("div",{className:"flex flex-col items-end gap-2",children:e.jsx(P,{color:M(s.priority),children:s.priority})})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(y,{placeholder:"Select Agent",className:"flex-1",value:r[s.id],onChange:a=>S(s.id,a),loading:v,children:N?.filter(a=>a.status==="AVAILABLE").map(a=>e.jsxs(y.Option,{value:a.id,children:[a.name," (",a.email,")"]},a.id))}),e.jsx(m,{type:"primary",className:"!bg-yellow",icon:e.jsx(O,{size:16}),loading:t===s.id,disabled:!r[s.id],onClick:()=>A(s.id),children:"Assign"})]})]},s.id)):e.jsxs("div",{className:"w-full bg-gray-50 rounded-xl p-8 border border-gray-200 text-center",children:[e.jsx(x,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No pending sessions"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"All conversations are being handled by agents"})]})})]})}function k(){const{data:t,isLoading:l}=h("/admin-dashboard/dashboard-stats/");return l?e.jsxs("div",{className:"pt-4 space-y-5",children:[e.jsx("h2",{className:"font-bold text-2xl",children:"Admin Dashboard"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-10",children:[1,2,3,4].map(r=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]},r))})]}):e.jsxs("div",{className:"pt-4 space-y-5",children:[e.jsx("h2",{className:"font-bold text-2xl",children:"Admin Dashboard"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6",children:[e.jsx(n,{title:"Pending Sessions",count:t?.pending_sessions||0}),e.jsx(n,{title:"Active Sessions",count:t?.active_sessions||0}),e.jsx(n,{title:"Total Agents",count:t?.total_agents||0}),e.jsx(n,{title:"Online Agents",count:t?.online_agents||0}),e.jsx(n,{title:"Total Users",count:t?.total_users||0}),e.jsx(n,{title:"Today's Chats",count:t?.today_conversations||0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-[30px]",children:[e.jsx(R,{}),e.jsx(D,{})]})]})}export{k as default};
