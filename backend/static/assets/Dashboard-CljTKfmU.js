import{r as l,v as M,_ as E,u as S,a as y,j as e,w as f,S as B,B as N,s as b}from"./index-Bl3f9Dxg.js";import{C as i}from"./Card-DJULRFTo.js";import{C as w}from"./index-Bqr4MUQ8.js";import{T as F}from"./index-C0z08d09.js";import{F as U}from"./Table-DBWGcoSo.js";import{T as o}from"./index-F0Avwo3O.js";import{M as O}from"./index-CXEQRxaO.js";import{R as _}from"./CheckOutlined-kg7jghGR.js";import"./SearchOutlined-BOVmvXrh.js";import"./TextArea-DyQsbb_N.js";import"./CopyOutlined-Bj_E3pFL.js";import"./index-BomJZn6k.js";import"./index-DHL8gz9z.js";import"./index-CrloEOjG.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},G=function(d,r){return l.createElement(M,E({},d,{ref:r,icon:V}))},J=l.forwardRef(G);const{Title:C,Text:c}=F,K=()=>{const[a,d]=l.useState(!1),[r,m]=l.useState(null),[n,q]=l.useState("approve"),[R,g]=l.useState(!1),[h,A]=l.useState(1),[j,P]=l.useState(10),{data:p,error:D,mutate:T,isLoading:k}=S("/admin-dashboard/plan-upgrade-requests/",()=>y.get("/admin-dashboard/plan-upgrade-requests/").then(s=>s.data)),x=Array.isArray(p)?p:p?.requests||[],v=(s,t)=>{m(s),q(t),d(!0)},I=async()=>{if(r){g(!0);try{await y.post(`/admin-dashboard/plan-upgrade-requests/${r.id}/review/`,{action:n,notes:`${n==="approve"?"Approved":"Declined"} by SuperAdmin`}),b.success(`Plan upgrade request ${n==="approve"?"approved":"declined"} successfully!`),T(),d(!1),m(null)}catch(s){console.error("Review error:",s),b.error(s.response?.data?.error||"Failed to process review. Please try again.")}finally{g(!1)}}},z=s=>{switch(s.toLowerCase()){case"pending":return e.jsx(o,{color:"orange",children:"Pending"});case"approved":return e.jsx(o,{color:"green",children:"Approved"});case"rejected":case"declined":return e.jsx(o,{color:"red",children:"Declined"});default:return e.jsx(o,{color:"default",children:s})}},u=s=>{const t={Bronze:"orange",Silver:"gray",Gold:"gold",Platinum:"blue",Diamond:"purple",Custom:"green"};return e.jsx(o,{color:t[s]||"default",children:s})},$=[{title:"S.N",key:"serialNumber",width:50,align:"center",render:(s,t,L)=>e.jsx("span",{className:"text-gray-600 font-medium",children:(h-1)*j+L+1})},{title:"Company Name",dataIndex:"company_name",key:"company_name",width:150,render:s=>e.jsx("div",{className:"font-semibold text-gray-800",children:s})},{title:"Company ID",dataIndex:"company_id",key:"company_id",width:120,render:s=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s})},{title:"Current Plan",dataIndex:"current_plan",key:"current_plan",width:120,align:"center",render:s=>u(s)},{title:"Requested Plan",dataIndex:"requested_plan",key:"requested_plan",width:120,align:"center",render:s=>u(s)},{title:"Status",dataIndex:"status",key:"status",width:100,align:"center",render:s=>z(s)},{title:"Requested Date",dataIndex:"requested_at",key:"requested_at",width:120,align:"center",render:s=>e.jsx("span",{className:"text-gray-600",children:new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})},{title:"Actions",key:"actions",width:160,align:"center",render:(s,t)=>t.status.toLowerCase()!=="pending"?e.jsx("span",{className:"text-gray-500 italic",children:t.status.toLowerCase()==="approved"?"Approved":"Declined"}):e.jsxs(B,{size:"small",children:[e.jsx(N,{type:"primary",size:"small",icon:e.jsx(_,{}),onClick:()=>v(t,"approve"),className:"bg-green-600 border-green-600 hover:bg-green-700 hover:border-green-700",children:"Approve"}),e.jsx(N,{danger:!0,size:"small",icon:e.jsx(f,{}),onClick:()=>v(t,"decline"),children:"Decline"})]})}];return D?e.jsx(w,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"text-4xl text-red-500 mb-4"}),e.jsx(C,{level:4,children:"Failed to load upgrade requests"}),e.jsx(c,{type:"secondary",children:"Please try refreshing the page"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(w,{title:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(C,{level:4,style:{margin:0},children:"Plan Upgrade Requests"}),e.jsxs(o,{color:"blue",children:[Array.isArray(x)?x.filter(s=>s.status.toLowerCase()==="pending").length:0," ","Pending"]})]}),className:"shadow-sm",children:e.jsx(U,{columns:$,dataSource:x||[],loading:k,rowKey:"id",pagination:{current:h,pageSize:j,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,t)=>`${t[0]}-${t[1]} of ${s} requests`,onChange:(s,t)=>{A(s),P(t||10)}}})}),e.jsx(O,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[n==="approve"?e.jsx(_,{className:"text-green-600"}):e.jsx(f,{className:"text-red-600"}),e.jsxs("span",{children:[n==="approve"?"Approve":"Decline"," Plan Upgrade Request"]})]}),open:a,onOk:I,onCancel:()=>{d(!1),m(null)},confirmLoading:R,okText:n==="approve"?"Approve":"Decline",okButtonProps:{danger:n==="decline",className:n==="approve"?"bg-green-600 border-green-600 hover:bg-green-700":""},children:r&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(c,{strong:!0,className:"text-gray-700",children:"Company Name:"}),e.jsx("div",{className:"font-medium",children:r.company_name})]}),e.jsxs("div",{children:[e.jsx(c,{strong:!0,className:"text-gray-700",children:"Company ID:"}),e.jsx("div",{className:"font-medium text-blue-600",children:r.company_id})]}),e.jsxs("div",{children:[e.jsx(c,{strong:!0,className:"text-gray-700",children:"Current Plan:"}),e.jsx("div",{className:"mt-1",children:u(r.current_plan)})]}),e.jsxs("div",{children:[e.jsx(c,{strong:!0,className:"text-gray-700",children:"Requested Plan:"}),e.jsx("div",{className:"mt-1",children:u(r.requested_plan)})]})]})}),e.jsx("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:e.jsxs(c,{className:"text-gray-600",children:["Are you sure you want to"," ",e.jsx("strong",{className:n==="approve"?"text-green-600":"text-red-600",children:n})," ","this plan upgrade request?"]})})]})})]})};function de(){const{data:a,isLoading:d}=S("/auth/super-admin-stats/");return d?e.jsxs("div",{className:"pt-4 space-y-5",children:[e.jsx("h2",{className:"font-bold text-2xl",children:"Dashboard"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 xl:grid-cols-4 gap-10",children:[1,2,3,4,5,6,7,8].map(r=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]},r))})]}):e.jsxs("div",{className:"pt-4 space-y-5",children:[e.jsx("h2",{className:"font-bold text-2xl",children:"Super Admin Dashboard"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(i,{title:"Total Companies",count:a?.total_companies||0}),e.jsx(i,{title:"Total Admins",count:a?.total_admins||0}),e.jsx(i,{title:"Total Agents",count:a?.total_agents||0}),e.jsx(i,{title:"Active Plans",count:a?.total_plans||0}),e.jsx(i,{title:"Active Sessions",count:a?.active_sessions||0}),e.jsx(i,{title:"Pending Sessions",count:a?.pending_sessions||0}),e.jsx(i,{title:"Total Users",count:a?.total_users||0}),e.jsx(i,{title:"Monthly Revenue",count:a?.monthly_revenue||0})]}),e.jsx("div",{className:"mt-8",children:e.jsx(K,{})})]})}export{de as default};
